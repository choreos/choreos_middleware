-- ##########################################################################
-- #                                                                        #
-- #                IMPORTANT DEVELOPMENT NOTICE:                           #
-- #                                                                        #
-- #   All ocurrences of '$ UUID' must be replaced with the actual storage  #
-- #        UUID before uploading the recipe to the chef-server             #             
-- #                                                                        #
-- ##########################################################################
 

DROP DATABASE IF EXISTS <%= node['storage'] ['$UUID']['schema'] %>;

CREATE DATABASE <%= node['storage'] ['$UUID']['schema'] %>;

GRANT ALL 
	ON  <%= node['storage'] ['$UUID']['schema'] %>.* 
	TO '<%= node['storage'] ['$UUID']['dbuser']   %>' 
	IDENTIFIED BY '<%= node['storage'] ['$UUID']['dbpassword'] %>';

GRANT ALL 
	ON  <%= node['storage'] ['$UUID']['schema'] %>.* 
	TO '<%= node['storage'] ['$UUID']['dbuser']   %>'@'localhost' 
	IDENTIFIED BY '<%= node['storage'] ['$UUID']['dbpassword'] %>';

GRANT ALL 
	ON  <%= node['storage'] ['$UUID']['schema'] %>.* 
	TO '<%= node['storage'] ['$UUID']['dbuser']   %>'@'%' 
	IDENTIFIED BY '<%= node['storage']['$UUID']['dbpassword'] %>';
