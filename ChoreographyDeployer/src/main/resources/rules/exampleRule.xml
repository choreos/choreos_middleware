<?xml version="1.0" encoding="UTF-8"?>
<ComplexEventRuleActionList
	xmlns="http://labse.isti.cnr.it/glimpse/xml/ComplexEventRule"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://labse.isti.cnr.it/glimpse/xml/ComplexEventRule ./ComplexEventRule.xsd">
	<Insert RuleType="drools">
		<RuleName>MessagesFromNS1Value</RuleName>
		<RuleBody>
			import it.cnr.isti.labse.glimpse.event.GlimpseBaseEventChoreos;
			import it.cnr.isti.labse.glimpse.manager.ResponseDispatcher;
			import it.cnr.isti.labse.glimpse.utils.NotifierUtils;

			declare GlimpseBaseEventChoreos
				@role( event )
				@timestamp( timeStamp )
			end

			rule "MessagesFromNS1Value"
			no-loop
			salience 999
			dialect "java"
			
			when
				$aEvent : GlimpseBaseEventChoreos(this.choreographySource == "CH1",
						this.getConsumed == false, this.isException == false);
			then
				$aEvent.setConsumed(true);
				update( $aEvent );
				retract( $aEvent );
			end
		</RuleBody>
	</Insert>
</ComplexEventRuleActionList>