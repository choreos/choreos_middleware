<?xml version="1.0" encoding="UTF-8"?>
<ComplexEventRuleActionList xmlns="http://labse.isti.cnr.it/glimpse/xml/ComplexEventRule"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="http://labse.isti.cnr.it/glimpse/xml/ComplexEventRule ./ComplexEventRule.xsd">
<Insert RuleType="drools">
	<RuleName>Generic SLA Monitor</RuleName>
        <RuleBody>
        import it.cnr.isti.labse.glimpse.event.GlimpseBaseEventChoreos;
        import it.cnr.isti.labse.glimpse.manager.ResponseDispatcher;
        import it.cnr.isti.labse.glimpse.utils.NotifierUtils;
        import it.cnr.isti.labse.glimpse.impl.ServiceLocatorImpl;
		import it.cnr.isti.labse.glimpse.impl.RuleTemplateEnum;
        
        declare GlimpseBaseEventChoreos
	        @role( event )
	        @timestamp( timeStamp )
        end
        
		rule "ruleOne"
		no-loop
		salience 999
		dialect "java"
		when
			$aEvent : GlimpseBaseEventChoreos(this.choreographySource == "CH1", 
				this.isConsumed == false, 
				this.isException == false, 
				this.getServiceSource == "resp1", 
				this.getEventName == "SLA Alert");
		then
			ServiceLocatorImpl.GetMachineIP("resp1",
			"a",
			"b",
			RuleTemplateEnum.INFRASTRUCTUREVIOLATION);
		end
        </RuleBody>
	</Insert>
</ComplexEventRuleActionList>